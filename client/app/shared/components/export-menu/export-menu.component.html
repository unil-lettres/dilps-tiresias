<button
    mat-icon-button
    [matMenuTriggerFor]="menu"
    [matTooltip]="tooltip"
    (menuOpened)="menuOpened()"
    (menuClosed)="menuClosed()"
>
    <mat-icon naturalIcon="share_windows" />
</button>
<mat-menu #menu="matMenu">
    <button mat-menu-item (click)="export(ExportFormat.Zip)">
        {{ optionZipLabel }}
    </button>
    @if (showExcelExportation) {
        <button mat-menu-item (click)="export(ExportFormat.Csv)">Exporter en Excel</button>
    }
    <button
        mat-menu-item
        [disabled]="!!pptValidationMessage"
        [matTooltip]="pptValidationMessage"
        [matMenuTriggerFor]="pptOptions"
        (click)="export(ExportFormat.Pptx)"
    >
        Exporter en PowerPoint
    </button>
</mat-menu>

<mat-menu #pptOptions="matMenu">
    <button mat-menu-item (click)="export(ExportFormat.Pptx, ExportTheme.light)">Thème clair</button>
    <button mat-menu-item (click)="export(ExportFormat.Pptx, ExportTheme.dark)">Thème sombre</button>
</mat-menu>
